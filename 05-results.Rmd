# Results

```{r}
library(tidyverse)
library(ggplot2)
```


```{r}
data <- read_csv("data/nyts_grouped.csv", show_col_types = FALSE)
```

## Advertisement 

It is not surprising that tobacco advertisements appears in everyday lives. One possible reason that youth start using tobacco products are because of ads

```{r, fig.width=10, fig.height=7}

internet_levels <- c("I do not use the Internet", "Never", "Rarely", "Sometimes", "Most of the time", "Always")

data %>% 
  select(c(1, 34, 37)) %>% 
  pivot_longer(-1, names_to="Questions", values_to="Response") %>% 
  mutate(Response = factor(Response, levels = rev(internet_levels))) %>% 
  group_by(Year, Questions, Response) %>% 
  summarise(count = n(), .groups = "drop") %>% 
  group_by(Year, Questions) %>% 
  mutate(percent = count/sum(count)) %>% 
  drop_na() %>% 
  ggplot(aes(x=Year, y=percent, color=Response)) + 
  geom_line(size=1) + geom_point() +
  facet_wrap(~Questions, dir="v") + 
  scale_color_viridis_d() +
  ggtitle("Comparison of How Often Youth See Ads on the Internet for cigarettes and e-cigarettes") + 
  theme(legend.position = "bottom")
```



```{r, fig.width=10, fig.height=7}

store_levels <- c("I never go to a convenience store, supermarket, or gas station", "Never", "Rarely", "Sometimes", "Most of the time", "Always")

data %>% 
  select(c(1, 35, 38)) %>% 
  pivot_longer(-1, names_to="Questions", values_to="Response") %>% 
  mutate(Response = factor(Response, levels = rev(store_levels))) %>% 
  group_by(Year, Questions, Response) %>% 
  summarise(count=n(), .groups = "drop") %>%
  group_by(Year, Questions) %>% 
  mutate(percent = count/sum(count)) %>% 
  drop_na() %>% 
  ggplot(aes(x=Year, y=percent, color=Response)) + 
  geom_line(size=1) + geom_point() +
  facet_wrap(~Questions, dir="v") + 
  scale_color_viridis_d() + 
  ggtitle("Comparison of How Often Youth See Ads on Stores for cigarettes and e-cigarettes") + 
  theme(legend.position = "bottom")
```

```{r, fig.width=10, fig.height=7}

streaming_levels <- c("I do not watch TV or streaming services, or go to the movies", "Never", "Rarely", "Sometimes", "Most of the time", "Always")

data %>% 
  select(c(1, 36, 39)) %>% 
  pivot_longer(-1, names_to="Questions", values_to="Response") %>% 
  mutate(Response = factor(Response, levels = rev(streaming_levels))) %>% 
  group_by(Year, Questions, Response) %>% 
  summarise(count=n(), .groups = "drop") %>%
  group_by(Year, Questions) %>% 
  mutate(percent = count/sum(count)) %>% 
  drop_na() %>% 
  ggplot(aes(x=Year, y=percent, color=Response)) + 
  geom_line(size=1) + geom_point() +
  facet_wrap(~Questions, dir="v") + 
  scale_color_viridis_d() +
  ggtitle("Comparison of How Often Youth See Ads on TV or Streaming Services for cigarettes and e-cigarettes") + 
  theme(legend.position = "bottom")
```

E-cigarettes are becoming popular in recent years as they have some fruity/sweet flavor comparing to traditional tobacco. 
We could clearly discover a trend that ads for e-cigarettes are increasing on the Internet and stores but not on TV or streaming services. The possible reason for the difference is that there are stricter control on what would be on TV than on the Internet and stores since the latter are the primary source where people gets tobacco products. 

Looking at the TV or streaming services plot, we can also relate the decreasing of tobacco/e-cigarettes ads to the legislation that legal age for tobacco products were raised from 18 to 21 years old in 2019. 



Another perspective we want to focus on is the relationship between ages, grades, and how often those youth see ads about tobacco products' ads. As we all know, people’s resistance to some attractive things will also increase as people grow. Thus, if a teenager sees too much promotion about cigarettes when he was even younger, it will be no surprise that this teenager started smoking at a very young age. So, we made those plots that describe the relationship between the age or grade and how often they see promotions. 

```{r, fig.width=10, fig.height=10}

age_levels <- c("9 years old", "10 years old", "11 years old", "12 years old", "13 years old", "14 years old", 
                "15 years old", "16 years old", "17 years old", "18 years old", "19 years old or older")

grades_levels <- c("6th", "7th", "8th", "9th", "10th", "11th", "12th", "Ungraded or other grade")

ads_labeller <- c(
  `When you are using the Internet, how often do you see ads or promotions for cigarettes or other tobacco products?`="Internet, cigarettes or other tobacco products",
  `When you go to a convenience store, supermarket, or gas station, how often do you see ads or promotions for cigarettes or other tobacco products?`="Stores, cigarettes or other tobacco products",
  `When you watch TV or streaming services (such as Netflix, Hulu, or Amazon Prime), or go to the movies, how often do you see ads or promotions for cigarettes or other tobacco products?`="TV or streaming, cigarettes or other tobacco products",
  `When you are using the Internet, how often do you see ads or promotions for e-cigarettes?`="Internet, e-cigarettes",
  `When you go to a convenience store, supermarket, or gas station, how often do you see ads or promotions for e-cigarettes?`="Stores, e-cigarettes",
  `When you watch TV or streaming services (such as Netflix, Hulu, or Amazon Prime), or go to the movies, how often do you see ads or promotions for e-cigarettes?`="TV or streaming, e-cigarettes"
)

age_grade_data <- data %>% 
  select(c(1, 2, 4, 34:39)) %>% 
  pivot_longer(-c(1,2,3), names_to="Questions", values_to="Response") %>% 
  rename(Age = 2, Grades = 3) %>% 
  mutate(Age = factor(Age, levels = age_levels),
         Grades = factor(Grades, levels = grades_levels))

age_grade_data %>%
  group_by(Year, Age, Questions, Response) %>% 
  summarise(count=n(), .groups = "drop") %>%
  group_by(Year, Age, Questions) %>% 
  mutate(percent = count/sum(count)) %>% 
  filter(Response == "Always") %>%
  drop_na() %>% 
  ggplot(aes(x=Year, y=percent, color=Age)) + 
  geom_line(size=1) + geom_point() +
  facet_wrap(~Questions, dir="v", ncol=3, labeller = as_labeller(ads_labeller)) + 
  scale_color_viridis_d() +
  ggtitle("Comparison of How Often Youth See for cigarettes and e-cigarettes by Age") +
  theme(legend.position = "bottom")
  
age_grade_data %>%
  group_by(Year, Grades, Questions, Response) %>% 
  summarise(count=n(), .groups = "drop") %>%
  group_by(Year, Grades, Questions) %>% 
  mutate(percent = count/sum(count)) %>% 
  filter(Response == "Always") %>%
  drop_na() %>% 
  ggplot(aes(x=Year, y=percent, color=Grades)) + 
  geom_line(size=1) + geom_point() +
  facet_wrap(~Questions, dir="v", ncol=3, labeller = as_labeller(ads_labeller)) + 
  scale_color_viridis_d() +
  ggtitle("Comparison of How Often Youth See for cigarettes and e-cigarettes by Grades") +
  theme(legend.position = "bottom")
```

The first graph here is ages vs. how often they see promotions. Let us first analyze traditional tobacco products and cigarettes, which is the upper part of this graph. Based on those graphs, we can clearly see that around 37 percent of 9 years old children always saw promotions for tobacco products through the internet. This number is terrifying because if a child has been affected by those tobacco promotions since nine years old, it will be very common for this child to become a smoking youth person. For the store, it looks like there are just constant promotions hung in those stores, and no matter who entered the store will be affected by it. This also can be shown through the plot. Based on the plot, for all ages’ people, around 15 to 30 percent of total popularity always saw promotions for tobacco products. Similarly, TV and streaming services here still affect the least amount of people. Those numbers are also decreasing, which can be interpreted as people who work for TV or streaming service are taking this seriously and trying to control the ads about tobacco products. 

Then, we switch our view to e-cigarettes, which are the lower part of the graph. Based on the graph, we can see that, no matter through which way, a large number of nine years old child always see the promotion of e-cigarettes. The promotion for e-cigarettes reached its peak in 2017 and there are around 30 to 40 percent of nine-year-old children always see those ads from both the internet, convenience stores, and TV. Although this number decreased a lot in 2020, those e-cigarettes’ promotions still affected a lot of young teenagers and children.

Now, let us look at the relationship between grades and promotions of tobacco products. The interesting thing here is that a group of people is labeled as ungraded, and around 40 percent of people in this group always see promotions for both cigarettes and e-cigarettes. As we all know, the grade should be related to ages, which means ungraded teenagers may have dropped their school or their family can not afford the education. It is obvious that a child or teenager without enough education will always be affected by smoking ads, since they may spend too much time on the internet, TV shows instead of school. Those children and teenagers are easier to smoke when they become youth adult.


## Race 


```{r, eval=FALSE}
sum(data[5], na.rm = TRUE) # Not Hispanic or Latino
sum(data[6], na.rm = TRUE) # Mexican
sum(data[7], na.rm = TRUE) # Puerto Rico
sum(data[8], na.rm = TRUE) # Cuba
sum(data[9], na.rm = TRUE) # Another Hispanic or Latino
sum(data[10], na.rm = TRUE) # American Indian or Alaska Native
sum(data[11], na.rm = TRUE) # Asian
sum(data[12], na.rm = TRUE) # Black or African American
sum(data[13], na.rm = TRUE) # Native Hawaiian or Other Pacific Islander
sum(data[14], na.rm = TRUE) # White
```

```{r, eval=FALSE}
sum(data[5][data[15] == 1], na.rm = TRUE) # Not Hispanic or Latino
sum(data[6][data[15] == 1], na.rm = TRUE) # Mexican
sum(data[7][data[15] == 1], na.rm = TRUE) # Puerto Rico
sum(data[8][data[15] == 1], na.rm = TRUE) # Cuba
sum(data[9][data[15] == 1], na.rm = TRUE) # Another Hispanic or Latino
sum(data[10][data[15] == 1], na.rm = TRUE) # American Indian or Alaska Native
sum(data[11][data[15] == 1], na.rm = TRUE) # Asian
sum(data[12][data[15] == 1], na.rm = TRUE) # Black or African American
sum(data[13][data[15] == 1], na.rm = TRUE) # Native Hawaiian or Other Pacific Islander
sum(data[14][data[15] == 1], na.rm = TRUE) # White
```

```{r}
race_ethnicity = c('Mexican', 'Puerto Rico', 'Cuba', 'Another Hispanic or Latino', 'American Indian or Alaska Native', 'Asian', 'Black or African American', 'Native Hawaiian or Other Pacific Islander', 'White')

total_race_count = c(13827, 2895, 1081, 10074, 7182, 6684, 18918, 2912, 56445)

smoked_per_race = c(2522, 508, 267, 1523, 1502, 747, 2958, 503, 9882)

race_df = data.frame(race_ethnicity, total_race_count, smoked_per_race)
```

```{r, fig.width=10, fig.height=10}
race_df <- race_df %>%
  mutate(percent_smoking = smoked_per_race / total_race_count) %>%
  arrange(percent_smoking)

race_bar <- race_df %>%
  ggplot(aes(x=reorder(race_ethnicity, desc(percent_smoking)), y=percent_smoking)) +
  geom_bar(color='blue', fill = 'lightblue', stat='identity') +
  theme(axis.text.x = element_text(angle = 45, hjust=1)) +
  xlab('Race/Ethnicity') +
  ylab('% Tried Smoking') +
  ggtitle('Percentage of Youth That Has Tried Smoking by Race/Ethnicity')

race_bar
```


As we can see by the breakdown by race/ethnicity above, almost 1 in every 4 of the youth that identify as Cuban have tried smoking. The percentage of youth identifying as Cuban who have tried smoking is over twice as much as the percentage of youth who identify as Asian. The percentage of the youth who identify as Hispanic or Latino and have tried smoking is about 17%, which is greater than most other race/ethnicities other than American Indian or Alaska Native. Approxmately 1 in 5 of the youth who identity as American Indian or Alaska Native have tried smoking. 


## Smoking Habits
```{r, fig.width=10, fig.height=10}
last_smoked <- na.omit(data[c(1,19)])

grouped_last_smoked <- last_smoked %>%
  group_by(Year, `When was the last time you smoked a cigeratte, even one or two puffs? (Please choose the first answer that fits)`) %>% 
  summarise(count=n(), .groups = "drop") 

grouped_last_smoked %>%
  ggplot(aes(x=`When was the last time you smoked a cigeratte, even one or two puffs? (Please choose the first answer that fits)`, y = count)) +
  geom_bar(stat = 'identity') +
  theme(axis.text.x = element_text(angle = 45, hjust=1))

grouped_last_smoked %>%
  ggplot(aes(x=`When was the last time you smoked a cigeratte, even one or two puffs? (Please choose the first answer that fits)`, y = count)) +
  geom_bar(stat = 'identity') +
  facet_wrap(~Year) +
  theme(axis.text.x = element_text(angle = 45, hjust=1))

```






